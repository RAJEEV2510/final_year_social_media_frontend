(this.webpackJsonphello=this.webpackJsonphello||[]).push([[13],{117:function(e,t,c){"use strict";c(0);var s=c(3);t.a=function(){return Object(s.jsxs)("div",{className:"post-placeholder",children:[Object(s.jsxs)("div",{className:"post-placeholder__header",children:[Object(s.jsx)("div",{className:"post-placeholder__img"}),Object(s.jsxs)("div",{className:"post-placeholder__info",children:[Object(s.jsx)("div",{className:"post-placeholder__username"}),Object(s.jsx)("div",{className:"post-placeholder__name"})]})]}),Object(s.jsxs)("div",{className:"post-placeholder__content",children:[Object(s.jsx)("div",{}),Object(s.jsx)("div",{}),Object(s.jsx)("div",{})]}),Object(s.jsxs)("div",{className:"post-placeholder__tail",children:[Object(s.jsx)("div",{className:"post-placeholder__like"}),Object(s.jsx)("div",{className:"post-placeholder__time"})]})]})}},536:function(e,t,c){"use strict";c.r(t);var s=c(48),a=c.n(s),n=c(49),r=c(18),i=c(0),o=c.n(i),l=c(9),d=c(51),j=c(8),u=c(52),h=(c(60),c(16)),b=c(108),p=c(231),f=c.n(p),m=(c(232),c(532)),O=c(3),_=o.a.memo((function(e){var t=e.user,c=e.isProfile,s=e.img,o=e.setImg,l=Object(d.a)(),p=l.loading,_=l.request,x=l.error,v=l.clearError,g=Object(i.useRef)(),N=Object(i.useRef)(0),k=Object(i.useState)(!1),y=Object(r.a)(k,2),w=y[0],S=y[1],C=Object(i.useState)(),E=Object(r.a)(C,2),A=E[0],T=E[1],D=Object(i.useState)("Add Friend"),I=Object(r.a)(D,2),P=I[0],R=I[1],F=JSON.parse(localStorage.getItem("userData2"))._id;Object(i.useEffect)((function(){fetch("https://socialbackends.herokuapp.com/allUser/".concat(F)).then((function(e){return e.json()})).then((function(e){if(null!=e){var c=e.friends.filter((function(e){return e==t._id}));console.log(P,c),c.length>=1?R("Unfriend"):R("Add Friend")}else R("Add Friend")}))}),[]);var M=function(){var e=Object(n.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=new FileReader).onload=function(){S(t.result)},t.readAsDataURL(A);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=function(){var e=Object(n.a)(a.a.mark((function e(c){var s,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=JSON.parse(localStorage.getItem("userData2")),(n=new FormData).append("x",c.x),n.append("y",c.y),n.append("width",c.width),n.append("height",c.height),n.append("img",A),e.prev=7,e.next=10,_("https://socialbackends.herokuapp.com/api"+"/users/img/".concat(t._id),"post",n,{Authorization:"Bearer "+t.token});case 10:r=e.sent,o(r.data.img),localStorage.setItem("userData2",JSON.stringify(Object(j.a)(Object(j.a)({},s),{},{img:r.data.img}))),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(7),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[7,15]])})));return function(t){return e.apply(this,arguments)}}();Object(i.useEffect)((function(){A&&M()}),[A]);return Object(O.jsxs)("div",{children:[p&&Object(O.jsx)(h.a,{}),w&&Object(O.jsx)("div",{className:"modal__container",children:Object(O.jsx)("div",{className:"modal",children:Object(O.jsxs)("div",{className:"modal__body cropper",onClick:function(e){return e.stopPropagation()},children:[Object(O.jsx)(f.a,{ref:N,src:w,style:{height:"80vh",width:"100%"},zoomable:!1,aspectRatio:1,viewMode:2,responsive:!0,guides:!1}),Object(O.jsxs)("div",{className:"modal__footer",children:[Object(O.jsx)("button",{className:"btn btn--outlined-danger",onClick:function(){return S(!1)},children:"Cancel"}),Object(O.jsx)("button",{className:"btn btn--contained-success",onClick:function(){S(null),q(N.current.cropper.getData())},children:"Submit"})]})]})})}),x&&Object(O.jsx)(b.a,{message:"there was a problem with the image!",closeModal:v}),Object(O.jsx)("div",{className:"profile__cover",style:{backgroundImage:"url(".concat(t.cover?t.cover:"https://cdn.dribbble.com/users/648922/screenshots/9157929/media/e5d45686a9feeefaff2780443188a2d8.png",")")}}),Object(O.jsxs)("div",{className:"profile__row",children:[c&&Object(O.jsx)("input",{ref:g,style:{display:"none"},type:"file",accept:".png,.jpg,.jpeg",onChange:function(e){var t;e.target.files&&1===e.target.files.length&&(t=e.target.files[0],T(t))}}),Object(O.jsxs)("div",{className:"profile__info",children:[Object(O.jsxs)("div",{className:"profile__info__picture",title:"Change your image",style:{cursor:"".concat(c?"pointer":"default")},onClick:c?function(){g.current.click()}:null,children:[Object(O.jsx)("img",{src:s||t.img,alt:"aa"}),c&&Object(O.jsx)("div",{className:"profile__info__picture--icon",children:Object(O.jsx)(u.g,{fill:"#fff",width:"2rem",height:"2rem"})})]}),Object(O.jsx)("h2",{className:"profile__info__username",children:t.username}),Object(O.jsx)("h2",{className:"profile__info__name",children:t.name})]}),Object(O.jsxs)("div",{className:"profile__info__statics",children:[Object(O.jsxs)("div",{className:"profile__info__statics--head",children:[Object(O.jsx)("h3",{children:"posts"}),Object(O.jsx)("h3",{children:"chat Friends"})]}),Object(O.jsx)("div",{className:"seprator"}),Object(O.jsxs)("div",{className:"profile__info__statics--result",children:[Object(O.jsx)("h3",{children:t.posts.length}),Object(O.jsx)("h3",{children:t.chatRooms.length})]}),t.about&&t.about.bio&&Object(O.jsx)("p",{className:"profile__info__bio",children:t.about.bio})]})]}),Object(O.jsx)("div",{className:"add_frnd_btn",style:{marginTop:"20px",width:"200px",marginLeft:"20px"},children:t._id!=F?Object(O.jsx)(m.a,{variant:"contained",style:{width:"100px!important",fontSize:"15px",borderRadius:"10px"},onClick:function(){!function(){if("Add Friend"==P){var e={addFrndId:JSON.parse(localStorage.getItem("userData2"))._id,frndId:t._id};console.log(e),fetch("https://socialbackends.herokuapp.com/updateFriends",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){console.log("Success:",e),R("UnFriend")})).catch((function(e){console.error("Error:",e)}))}else{var c={addFrndId:JSON.parse(localStorage.getItem("userData2"))._id,frndId:t._id};fetch("https://socialbackends.herokuapp.com/updateunFriends",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}).then((function(e){return e.json()})).then((function(e){console.log("Success:",e),R("Add Friend")})).catch((function(e){console.error("Error:",e)}))}}()},children:P}):""}),Object(O.jsxs)("div",{className:"profile__about",children:[Object(O.jsx)("h2",{children:"About"}),Object(O.jsx)("div",{className:"seprator"}),Object(O.jsxs)("div",{className:"profile__about__field",children:[Object(O.jsxs)("div",{className:"profile__about__field__quest",children:[Object(O.jsx)(u.j,{}),Object(O.jsx)("h4",{children:"Joined at "})]}),Object(O.jsx)("p",{children:new Date(t.createdAt).toLocaleDateString()})]}),t.about&&t.about.livesIn&&Object(O.jsxs)("div",{className:"profile__about__field",children:[Object(O.jsxs)("div",{className:"profile__about__field__quest",children:[Object(O.jsx)(u.B,{}),Object(O.jsx)("h4",{children:"lives in"})]}),Object(O.jsx)("p",{children:t.about.livesIn})]}),t.about&&t.about.from&&Object(O.jsxs)("div",{className:"profile__about__field",children:[Object(O.jsxs)("div",{className:"profile__about__field__quest",children:[Object(O.jsx)(u.u,{}),Object(O.jsx)("h4",{children:"from"})]}),Object(O.jsx)("p",{children:t.about.from})]}),t.about&&t.about.birth&&Object(O.jsxs)("div",{className:"profile__about__field",children:[Object(O.jsxs)("div",{className:"profile__about__field__quest",children:[Object(O.jsx)(u.f,{}),Object(O.jsx)("h4",{children:"was born on"})]}),Object(O.jsx)("p",{children:t.about.birth})]}),t.about&&t.about.gender&&Object(O.jsxs)("div",{className:"profile__about__field",children:[Object(O.jsxs)("div",{className:"profile__about__field__quest",children:[Object(O.jsx)(u.K,{}),Object(O.jsx)("h4",{children:"gender "})]}),Object(O.jsx)("p",{children:t.about.gender})]})]})]})})),x=_,v=c(2),g=c(94),N=c(117),k=(c(89),o.a.memo((function(e){var t=e.length,c=e.isProfile,s=e.user,o=e.img,j=e.username,u=e.id,h=Object(l.c)((function(e){return e.userPost})),b=Object(i.useState)([]),p=Object(r.a)(b,2),f=p[0],m=p[1],_=Object(d.a)(),x=_.request,k=_.loading,y=_.error,w=Object(l.b)(),S=Object(i.useState)(!0),C=Object(r.a)(S,2),E=(C[0],C[1]),A=function(){var e=Object(n.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x("https://socialbackends.herokuapp.com/api"+"/users/".concat(u,"?skip=").concat(c?h.length:f.length));case 3:(t=e.sent).data.posts.length<5&&E(!1),c?w({type:"MORE_POSTS",payload:t.data.posts}):m((function(e){return[].concat(Object(v.a)(e),Object(v.a)(t.data.posts))})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0,y);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(i.useEffect)((function(){A()}),[]),Object(O.jsxs)("div",{className:"mt-5",children:[(c?h:f).map((function(e){return Object(O.jsx)(g.a,{path:"stay",post:e,username:j,img:o,uid:s._id,token:s.token},e._id)})),k&&Object(O.jsx)("div",{children:Object(O.jsx)(N.a,{})}),!k&&(c&&t>h.length||!c&&t>f.length)&&Object(O.jsx)("div",{className:"has-more",children:Object(O.jsx)("button",{className:"nude",onClick:A,children:"Load More Posts"})})]})}))),y=k,w=function(){return Object(O.jsxs)("div",{div:!0,className:"mt-5",children:[Object(O.jsxs)("div",{className:"profile-placehoder",children:[Object(O.jsxs)("div",{className:"profile-placehoder__header",children:[Object(O.jsx)("div",{className:"profile-placehoder__header--icon"}),Object(O.jsx)("h2",{})]}),Object(O.jsx)("div",{className:"profile-placehoder__cover"}),Object(O.jsxs)("div",{className:"profile-placehoder__row",children:[Object(O.jsxs)("div",{className:"profile-placehoder__info",children:[Object(O.jsx)("div",{className:"profile-placehoder__info__picture"}),Object(O.jsx)("h2",{className:"profile-placehoder__info__username"}),Object(O.jsx)("h2",{className:"profile-placehoder__info__name"})]}),Object(O.jsxs)("div",{className:"profile-placehoder__info__statics",children:[Object(O.jsxs)("div",{className:"profile-placehoder__info__statics--head",children:[Object(O.jsx)("h3",{}),Object(O.jsx)("h3",{})]}),Object(O.jsx)("div",{className:"seprator"}),Object(O.jsxs)("div",{className:"profile-placehoder__info__statics--result",children:[Object(O.jsx)("h3",{}),Object(O.jsx)("h3",{})]}),Object(O.jsx)("p",{className:"profile-placehoder__info__bio"})]})]})]}),Object(O.jsx)(N.a,{}),Object(O.jsx)(N.a,{}),Object(O.jsx)(N.a,{})]})},S=c(47);c(21),t.default=function(e){var t=Object(d.a)(),c=t.loading,s=t.request,o=(t.error,Object(i.useState)(null)),j=Object(r.a)(o,2),u=j[0],h=j[1],b=Object(i.useState)(null),p=Object(r.a)(b,2),f=p[0],m=p[1],_=Object(l.c)((function(e){return e.currentUser})),v=e.match.params.id,g=function(){var e=Object(n.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s("https://socialbackends.herokuapp.com/api"+"/users/".concat(v));case 3:t=e.sent,h(t.data.user),t.data.user&&t.data.user.username&&(c=t.data.user.username,document.title=c),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}var c}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();if(Object(i.useEffect)((function(){g()}),[v]),!c&&u&&u._id&&_&&_.token){var N=_._id===u._id;return N&&"/user/:id"===e.match.path?Object(O.jsx)(S.a,{to:"/profile/".concat(u._id)}):N||"/profile/:id"!==e.match.path?Object(O.jsxs)("div",{className:"profile ".concat(N?"mt-2":""),children:[!N&&Object(O.jsxs)("div",{className:"profile__header",children:[Object(O.jsx)("div",{className:"profile__header--icon"}),Object(O.jsx)("h2",{children:u.username})]}),Object(O.jsx)(x,{user:u,img:f,setImg:function(e){m(e)},isProfile:N}),Object(O.jsx)(y,{length:u.posts.length,user:_,id:v,isProfile:N,img:f||u.img,username:u.username})]}):Object(O.jsx)(S.a,{to:"/user/".concat(v)})}return Object(O.jsx)(w,{})}},63:function(e,t,c){"use strict";c.d(t,"a",(function(){return o}));var s=c(48),a=c.n(s),n=c(49),r=c(18),i=c(0),o=function(){var e=Object(i.useState)(!1),t=Object(r.a)(e,2),c=t[0],s=t[1],o=Object(i.useState)(),l=Object(r.a)(o,2),d=l[0],j=l[1],u=Object(i.useRef)([]),h=Object(i.useCallback)(function(){var e=Object(n.a)(a.a.mark((function e(t){var c,n,r,i,o,l,d=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=d.length>1&&void 0!==d[1]?d[1]:"GET",n=d.length>2&&void 0!==d[2]?d[2]:null,r=d.length>3&&void 0!==d[3]?d[3]:{"Content-Type":"application/json"},s(!0),i=new AbortController,u.current.push(i),e.prev=6,e.next=9,fetch(t,{method:c,body:n,headers:r,signal:i.signal});case 9:return o=e.sent,e.next=12,o.json();case 12:if(l=e.sent,u.current=u.current.filter((function(e){return e!==i})),o.ok){e.next=16;break}throw new Error(l.message);case 16:return s(!1),e.abrupt("return",l);case 20:throw e.prev=20,e.t0=e.catch(6),j(e.t0.message),s(!1),e.t0;case 25:case"end":return e.stop()}}),e,null,[[6,20]])})));return function(t){return e.apply(this,arguments)}}(),[]);return Object(i.useEffect)((function(){return function(){u.current.forEach((function(e){return e.abort()}))}}),[]),{isLoading:c,error:d,sendRequest:h,clearError:function(){j(null)}}}},94:function(e,t,c){"use strict";var s=c(48),a=c.n(s),n=c(8),r=c(49),i=c(18),o=c(0),l=c(52),d=(c(109),c(46)),j=c(63),u=c(9),h=c(16),b=c(21),p=c(534),f=c(3),m=function(e){var t=e.path,c=e.children,s=e.title,n=e.id,l=Object(j.a)(),m=l.isLoading,O=(l.error,l.sendRequest),_=Object(o.useState)(!1),x=Object(i.a)(_,2),v=x[0],g=x[1],N=Object(u.b)(),k=Object(u.c)((function(e){return e.isSignedIn})),y=function(){v&&(g(!1),document.body.style.overflowY="auto")},w=function(){var e=Object(r.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O("https://socialbackends.herokuapp.com/api"+"/posts/".concat(n),"DELETE",null,{"Content-Type":"application/json",Authorization:"Bearer "+k});case 3:N({type:"DELETE_POST",payload:n}),console.log(n),t?N({type:"DELETE_USER_POST",payload:n}):b.a.push(""),y(),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("div",{style:{display:"inline-block"},onClick:function(){v||(g(!0),document.body.style.overflowY="hidden")},children:c}),Object(f.jsx)(p.a,{in:v,timeout:300,classNames:"modal",unmountOnExit:!0,children:Object(f.jsx)("div",{className:"modal__container",onClick:y,children:Object(f.jsx)("div",{className:"modal",children:Object(f.jsx)("div",{className:"modal__body",onClick:function(e){return e.stopPropagation()},children:Object(f.jsxs)("ul",{className:"modal__list",children:[Object(f.jsx)("li",{className:"modal__item",children:Object(f.jsx)(d.a,{onClick:y,to:{pathname:"/posts/edit/".concat(n),state:{title:s}},children:"Edit Post"})}),Object(f.jsx)("li",{className:"modal__item delete",onClick:function(){w()},children:m?"Deleting...":"Delete Post"}),Object(f.jsx)("li",{className:"modal__item",onClick:y,children:"Cancel"})]})})})})}),m&&Object(f.jsx)(h.a,{})]})},O=c(61),_=c(62),x=c(121),v=c(119),g=c(110),N=(c(111),function(e){Object(x.a)(c,e);var t=Object(v.a)(c);function c(e){return Object(O.a)(this,c),t.call(this,e)}return Object(_.a)(c,[{key:"render",value:function(){var e=this.props,t=e.image,c=e.closeLightBox;return Object(f.jsx)("div",{children:Object(f.jsx)(g.a,{mainSrc:t,onCloseRequest:c})})}}]),c}(o.Component)),k=c(59),y=c(149),w=c.n(y);c(107),t.a=function(e){var t,c,s,u,h,b,p,O=e.post,_=e.path,x=e.uid,v=e.token,g=e.img,y=e.username,S=Object(o.useState)(O.liked.indexOf(x)),C=Object(i.a)(S,2),E=C[0],A=C[1],T=Object(o.useRef)(O.liked.length),D=Object(o.useRef)(null),I=Object(j.a)().sendRequest,P=Object(o.useState)(!1),R=Object(i.a)(P,2),F=R[0],M=R[1],q=(w.a,function(){var e=Object(r.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I("https://socialbackends.herokuapp.com/api/posts/post","PATCH",JSON.stringify({postId:O._id,creator:x,img:g,username:y}),{"Content-Type":"application/json",Authorization:"Bearer "+v});case 3:t=e.sent,k.a.emit("action",Object(n.a)(Object(n.a)({},t),{},{type:"SEND_NOTFY"})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}()),J=Object(o.useState)(),L=Object(i.a)(J,2),U=L[0];L[1];Object(o.useEffect)((function(){if(D.current){var e=setTimeout((function(){q()}),500);return function(){return clearTimeout(e)}}}),[E]);return Object(f.jsxs)("div",{className:"post",children:[F&&Object(f.jsx)(N,{image:F,closeLightBox:function(){return M(!1)}}),Object(f.jsxs)("div",{className:"post__header",children:[Object(f.jsxs)("div",{className:"post__header--info",children:[Object(f.jsxs)("div",{className:"post__header--img",children:[(null===(t=O.creator)||void 0===t?void 0:t.isOnline)&&Object(f.jsx)("div",{className:"userActive"}),Object(f.jsx)(d.a,{to:"/user/".concat((null===O||void 0===O||null===(c=O.creator)||void 0===c?void 0:c._id)||O.creator),children:Object(f.jsx)("img",{src:(null===O||void 0===O||null===(s=O.creator)||void 0===s?void 0:s.img)||g,alt:"aa"})})]}),Object(f.jsxs)("div",{className:"post__header--name",children:[Object(f.jsx)(d.a,{to:"/user/".concat((null===(u=O.creator)||void 0===u?void 0:u._id)||O.creator),children:Object(f.jsx)("span",{className:"name",children:(null===(h=O.creator)||void 0===h?void 0:h.username)||y})}),"null"!==O.location&&Object(f.jsx)("span",{className:"place",children:O.location})]})]}),x===((null===(b=O.creator)||void 0===b?void 0:b._id)?null===(p=O.creator)||void 0===p?void 0:p._id:O.creator)&&Object(f.jsx)(m,{path:_,id:U||O._id,title:O.title,children:Object(f.jsx)("div",{className:"post__menu",children:Object(f.jsx)("span",{className:"icon",children:Object(f.jsx)(l.A,{width:"2.3rem",height:"2.3rem",fill:"#fff"})})})})]}),O.title&&Object(f.jsx)("div",{className:"post__content",children:Object(f.jsx)("p",{children:O.title?O.title:null})}),O.img&&Object(f.jsx)("div",{className:"post__body",children:Object(f.jsx)("img",{src:O.img,onClick:function(){return M(O.img)}})}),Object(f.jsxs)("div",{className:"post__tail",children:[Object(f.jsxs)("div",{className:"post__tail__communication",children:[Object(f.jsxs)("div",{className:"post__tail__communication__item",children:[Object(f.jsx)("span",{className:"icon",onClick:function(){E<0?++T.current:--T.current,A((function(e){return 0===e?-1:-1*e})),D.current||(D.current=1)},children:E<0?Object(f.jsx)(l.s,{width:"2rem",height:"2rem",fill:"#fff"}):Object(f.jsx)(l.t,{width:"2rem",height:"2rem",fill:"#fff"})}),Object(f.jsx)("span",{className:"nol",children:T.current})]}),Object(f.jsx)(d.a,{to:"/post/".concat(O._id),children:Object(f.jsxs)("div",{className:"post__tail__communication__item",children:[Object(f.jsx)("span",{className:"icon",children:Object(f.jsx)(l.n,{width:"2rem",height:"2rem",fill:"#fff"})}),Object(f.jsx)("span",{className:"nol",children:O.comments?O.comments.length:0})]})})]}),Object(f.jsx)("div",{className:"post__tail--time-left",children:function(e){var t=new Date,c=new Date(e).getTime(),s=(t.getTime()-c)/36e5;if(s<1){var a=Math.ceil(60*s);return a+(1===a?" MINUTE":" MINUTES")+" AGO"}if(s<24){var n=Math.floor(s);return n+(1===n?" Hour":" Hours")+" AGO"}if(s<168){var r=Math.floor(s/24);return r+" Day AGO"}if(s<720){var i=Math.floor(s/168);return i+(1===i?" Week":" Weeks")+" AGO"}if(s<8760){var o=Math.floor(s/720);return o+(1===o?" Month":" Months")+" AGO"}var l=Math.floor(s/8760);return l+(1===l?" Year":" Years")+" AGO"}(O.createdAt)})]})]},O._id)}}}]);
//# sourceMappingURL=13.c33d4818.chunk.js.map