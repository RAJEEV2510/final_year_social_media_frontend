{"version":3,"sources":["components/posts/edit-post.js"],"names":["EditPost","props","useForm","register","handleSubmit","useFetch","loading","error","request","id","match","params","useState","location","state","title","setTitle","dispatch","useDispatch","token","useSelector","isSignedIn","onSubmit","data","a","process","Authorization","type","payload","history","push","console","log","fetchPost","res","post","useEffect","document","className","onClick","goBack","viewBox","d","ref","defaultValue","name","placeholder","disabled"],"mappings":"0LA0GeA,UApGE,SAACC,GAChB,MAAmCC,cAA3BC,EAAR,EAAQA,SAAUC,EAAlB,EAAkBA,aAClB,EAAoCC,cAArBC,GAAf,EAAQC,MAAR,EAAeD,SAASE,EAAxB,EAAwBA,QAClBC,EAAKR,EAAMS,MAAMC,OAAOF,GAC9B,EAA0BG,mBACxBX,EAAMY,SAASC,MAAQb,EAAMY,SAASC,MAAMC,MAAQ,MADtD,mBAAOA,EAAP,KAAcC,EAAd,KAGMC,EAAWC,cACXC,EAAQC,aAAY,SAACN,GAAD,OAAWA,EAAMO,cACrCC,EAAQ,uCAAG,WAAOC,GAAP,SAAAC,EAAA,+EAEPhB,EACJiB,2CAAA,sBAAmDhB,GACnD,QACAc,EACA,CACEG,cAAe,UAAYP,IAPlB,OAUbF,EAAS,CACPU,KAAM,YACNC,QAAS,CACPnB,KACAM,MAAOQ,EAAKR,SAGhBd,EAAM4B,QAAQC,KAAK,KAjBN,gDAmBbC,QAAQC,IAAR,MAnBa,yDAAH,sDAsBRC,EAAS,uCAAG,4BAAAT,EAAA,+EAEIhB,EAChBiB,2CAAA,iBAA8ChB,IAHlC,OAERyB,EAFQ,OAKdlB,EAASkB,EAAIX,KAAKY,KAAOD,EAAIX,KAAKY,KAAKpB,MAAQ,IAC1CmB,EAAIX,KAAKY,MAAMlC,EAAM4B,QAAQC,KAAK,KANzB,gDAQdC,QAAQC,IAAR,MARc,yDAAH,qDAkBf,OAPAI,qBAAU,WACRC,SAAStB,MAAM,iBACVA,GACHkB,MAED,KAEElB,GAAST,EAEV,8BACE,cAAC,IAAD,MAKJ,gCACE,sBAAKgC,UAAU,kBAAf,UACE,qBACEA,UAAU,wBACVC,QAAS,kBAAMtC,EAAM4B,QAAQW,UAF/B,SAIE,qBAAKC,QAAQ,YAAb,SACE,4BACE,sBAAMC,EAAE,iOAId,mDAEF,sBAAKJ,UAAU,kBAAf,UACE,qBAAKA,UAAU,YACf,qBAAKA,UAAU,gBAAf,SACE,+CAEF,qBAAKA,UAAU,OAAf,SACE,uBAAMA,UAAU,iBAAiBhB,SAAUlB,EAAakB,GAAxD,UACE,qBAAKgB,UAAU,aAAf,SACE,qBAAKA,UAAU,sBAAf,SACE,0BACEK,IAAKxC,EACLyC,aAAc7B,EACd8B,KAAK,QACLC,YAAY,6BAIlB,wBACEC,SAAUzC,EACVgC,UAAU,sCAFZ,SAIGhC,EAAU,eAAiB","file":"static/js/16.2777d781.chunk.js","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport Loading from \"../../shared/models/loading-modal\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { useFetch } from \"../../shared/hooks/useFetch\";\r\n\r\nconst EditPost = (props) => {\r\n  const { register, handleSubmit } = useForm();\r\n  const { error, loading, request } = useFetch();\r\n  const id = props.match.params.id;\r\n  const [title, setTitle] = useState(\r\n    props.location.state ? props.location.state.title : null\r\n  );\r\n  const dispatch = useDispatch();\r\n  const token = useSelector((state) => state.isSignedIn);\r\n  const onSubmit = async (data) => {\r\n    try {\r\n      await request(\r\n        process.env.REACT_APP_BACKEND_URL + `/posts/edit/${id}`,\r\n        \"patch\",\r\n        data,\r\n        {\r\n          Authorization: \"Bearer \" + token,\r\n        }\r\n      );\r\n      dispatch({\r\n        type: \"EDIT_POST\",\r\n        payload: {\r\n          id,\r\n          title: data.title,\r\n        },\r\n      });\r\n      props.history.push(\"/\");\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n  const fetchPost = async () => {\r\n    try {\r\n      const res = await request(\r\n        process.env.REACT_APP_BACKEND_URL + `/posts/${id}`\r\n      );\r\n      setTitle(res.data.post ? res.data.post.title : \"\");\r\n      if (!res.data.post) props.history.push(\"/\");\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n  useEffect(() => {\r\n    document.title=\"Edit your post\"\r\n    if (!title) {\r\n      fetchPost();\r\n    }\r\n  }, []);\r\n\r\n  if (!title && loading) {\r\n    return (\r\n      <div>\r\n        <Loading />\r\n      </div>\r\n    );\r\n  }\r\n  return (\r\n    <div>\r\n      <div className=\"profile__header\">\r\n        <div\r\n          className=\"profile__header--icon\"\r\n          onClick={() => props.history.goBack()}\r\n        >\r\n          <svg viewBox=\"0 0 24 24\">\r\n            <g>\r\n              <path d=\"M20 11H7.414l4.293-4.293c.39-.39.39-1.023 0-1.414s-1.023-.39-1.414 0l-6 6c-.39.39-.39 1.023 0 1.414l6 6c.195.195.45.293.707.293s.512-.098.707-.293c.39-.39.39-1.023 0-1.414L7.414 13H20c.553 0 1-.447 1-1s-.447-1-1-1z\"></path>\r\n            </g>\r\n          </svg>\r\n        </div>\r\n        <h2>Edit Your Post</h2>\r\n      </div>\r\n      <div className=\"form__container\">\r\n        <div className=\"divider\" />\r\n        <div className=\"form__heading\">\r\n          <h3>Edit a post</h3>\r\n        </div>\r\n        <div className=\"form\">\r\n          <form className=\"form__body big\" onSubmit={handleSubmit(onSubmit)}>\r\n            <div className=\"form__unit\">\r\n              <div className=\"form__unit features\">\r\n                <textarea\r\n                  ref={register}\r\n                  defaultValue={title}\r\n                  name=\"title\"\r\n                  placeholder=\"what in your mind..?\"\r\n                ></textarea>\r\n              </div>\r\n            </div>\r\n            <button\r\n              disabled={loading}\r\n              className=\"btn btn--contained1-primary mg-none\"\r\n            >\r\n              {loading ? \"Updating....\" : \"Update\"}\r\n            </button>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nexport default EditPost;\r\n"],"sourceRoot":""}