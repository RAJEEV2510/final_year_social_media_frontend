(this.webpackJsonphello=this.webpackJsonphello||[]).push([[11],{115:function(e,t,c){"use strict";c(0);var n=c(3);t.a=function(){return Object(n.jsxs)("div",{className:"post-placeholder",children:[Object(n.jsxs)("div",{className:"post-placeholder__header",children:[Object(n.jsx)("div",{className:"post-placeholder__img"}),Object(n.jsxs)("div",{className:"post-placeholder__info",children:[Object(n.jsx)("div",{className:"post-placeholder__username"}),Object(n.jsx)("div",{className:"post-placeholder__name"})]})]}),Object(n.jsxs)("div",{className:"post-placeholder__content",children:[Object(n.jsx)("div",{}),Object(n.jsx)("div",{}),Object(n.jsx)("div",{})]}),Object(n.jsxs)("div",{className:"post-placeholder__tail",children:[Object(n.jsx)("div",{className:"post-placeholder__like"}),Object(n.jsx)("div",{className:"post-placeholder__time"})]})]})}},489:function(e,t,c){},535:function(e,t,c){"use strict";c.r(t);var n=c(8),a=c(18),s=c(0),r=c.n(s),i=c(48),o=c.n(i),l=c(49),j=c(94),d=c(60),u=c(51),b=c(9),m=c(115),h=c(89),O=c(3),p=r.a.memo((function(e){var t,c=e.token,n=e.uid,a=e.img,r=e.username,i=Object(u.a)(),d=i.request,p=(i.loading,i.error),f=Object(b.c)((function(e){return e.posts})),x=Object(b.b)(),v=function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d("https://socialbackends.herokuapp.com/api"+"/posts?skip=".concat(f.posts.length));case 3:t=e.sent,x({type:"FETCH_POSTS",payload:{posts:t.data.posts,length:t.data.length}}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0,p);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){f.posts.length||v(),document.title="Leechi"}),[]),t=f.posts&&f.posts.length?Object(O.jsxs)(h.a,{dataLength:f.length,next:v,hasMore:f.posts.length<f.length,loader:Object(O.jsxs)("div",{children:[Object(O.jsx)(m.a,{}),Object(O.jsx)(m.a,{})]}),endMessage:Object(O.jsx)("p",{style:{textAlign:"center"},className:"no-more",children:Object(O.jsx)("b",{children:"Yay! You have seen it all"})}),children:[f.posts.map((function(e){return Object(O.jsx)(j.a,{img:a,username:r,uid:n,token:c,post:e},e._id)})),";"]}):p?Object(O.jsxs)("h1",{children:[p," please try again later."]}):Object(O.jsxs)("div",{children:[Object(O.jsx)(m.a,{}),Object(O.jsx)(m.a,{}),Object(O.jsx)(m.a,{})]}),Object(O.jsx)("div",{children:t})})),f=p,x=c(52),v=c(95),_=c.n(v),g=c(106),N=c(16),k=r.a.memo((function(e){var t=e.handleLocation,c=e.location,n=Object(s.useState)(null),r=Object(a.a)(n,2),i=r[0],o=r[1],l=Object(s.useState)(!1),j=Object(a.a)(l,2),d=j[0],u=j[1],b=Object(s.useCallback)((function(){o(null)}),[]),m=function(e){u(!0);var c=e.coords,n=c.latitude,a=c.longitude,s="https://api.weatherbit.io/v2.0/current?lat=".concat(n,"&lon=").concat(a,"&key=")+"1f701621ea254a1cb3113097e5971fe4";_.a.get(s).then((function(e){t(e.data.data[0].city_name)})).catch((function(e){o(e.message)})),u(!1)},h=function(e){o(function(e){switch(e.code){case e.PERMISSION_DENIED:return"You have to make location allow first!";case e.POSITION_UNAVAILABLE:return"POSITION_UNAVAILABLE";case e.TIMEOUT:return"TIMEOUT";default:return"UNKNOWN_ERROR"}}(e)),u(!1)};return Object(s.useEffect)((function(){return window.addEventListener("click",b),function(){return window.removeEventListener("click",b)}}),[b]),Object(O.jsxs)(O.Fragment,{children:[d&&Object(O.jsx)(N.a,{}),i&&Object(O.jsx)(g.a,{state:"error",closeModal:b,message:i}),Object(O.jsx)("span",{className:"icon",onClick:c?function(){t(null)}:function(){navigator.geolocation?(u(!0),navigator.geolocation.getCurrentPosition(m,h)):console.log("your browser dosnot support geolocation")},children:Object(O.jsx)(x.x,{width:"2.2rem",height:"2.4rem",fill:c?"#1D8CF8":"#8B8B85"})})]})})),y=c(207),w=c(231),E=c.n(w),S=(c(232),c(468)),C=c.n(S),T=r.a.memo((function(e){var t=e.previewUrl,c=e.removeImage,n=e.setImgData,r=Object(s.useState)(null),i=Object(a.a)(r,2),o=i[0],l=i[1],j=Object(s.useRef)(0);return Object(O.jsxs)("div",{children:[o&&Object(O.jsx)("div",{className:"modal__container",children:Object(O.jsx)("div",{className:"modal",children:Object(O.jsxs)("div",{className:"modal__body cropper",onClick:function(e){return e.stopPropagation()},children:[Object(O.jsx)(E.a,{ref:j,src:t,style:{height:"80vh",width:"100%"},zoomable:!1,aspectRatio:1,viewMode:2,responsive:!0,guides:!1}),Object(O.jsxs)("div",{className:"modal__footer",children:[Object(O.jsx)("button",{className:"btn btn--outlined-danger",onClick:function(){return l(!1)},children:"Cancel"}),Object(O.jsx)("button",{className:"btn btn--contained-success",onClick:function(){l(null),n(j.current.cropper.getData())},children:"Submit"})]})]})})}),t?Object(O.jsx)("div",{className:"form__images--container",children:Object(O.jsxs)("div",{className:"form__images--row",children:[Object(O.jsx)("div",{children:Object(O.jsx)(C.a,{children:Object(O.jsx)("div",{className:"img",children:Object(O.jsx)("img",{src:t,alt:"aa"})})})}),Object(O.jsxs)("div",{className:"form__images--options",children:[Object(O.jsx)("span",{className:"icon del",onClick:c,children:Object(O.jsx)(x.k,{width:"2.2rem",height:"2.2rem",fill:"#fff"})}),Object(O.jsx)("span",{className:"icon crop",onClick:function(){l(!0)},children:Object(O.jsx)(x.o,{width:"2.2rem",height:"2.2rem",fill:"#fff"})})]})]})}):null]})})),A=r.a.memo((function(e){var t=e.user,c=Object(u.a)(),r=c.loading,i=c.request,j=c.error,d=c.clearError,m=Object(s.useState)(""),h=Object(a.a)(m,2),p=h[0],f=h[1],v=Object(s.useState)(null),_=Object(a.a)(v,2),w=_[0],E=_[1],S=Object(b.b)(),C=Object(s.useRef)(),A=Object(s.useState)(),D=Object(a.a)(A,2),I=D[0],M=D[1],R=Object(s.useState)(),L=Object(a.a)(R,2),P=L[0],U=L[1],B=Object(s.useState)(),F=Object(a.a)(B,2),Y=F[0],G=F[1],q=function(e){U(null),M(null)},z=function(){var e=Object(l.a)(o.a.mark((function e(c){var a,s,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=new FormData,Y&&Y.width&&(a.append("x",Y.x),a.append("y",Y.y),a.append("width",Y.width),a.append("height",Y.height)),a.append("title",c.title),a.append("location",c.location),a.append("img",c.img),a.append("creator",c.creator),e.next=9,i("https://socialbackends.herokuapp.com/api/posts","post",a,{Authorization:"Bearer "+t.token});case 9:s=e.sent,r={createdAt:(new Date).toISOString(),username:t.username,img:t.img,_id:t.id,isOnline:!0},S({type:"CREATE_POST",payload:Object(n.a)(Object(n.a)({},s.data.post),{},{creator:r})}),S({type:"ONE_MORE_POST",payload:Object(n.a)(Object(n.a)({},s.data.post),{},{creator:r})}),q(),f(""),E(null),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.log(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){if(P){var e=new FileReader;e.onload=function(){M(e.result)},e.readAsDataURL(P)}}),[P]),Object(O.jsxs)("div",{className:"form__container",children:[r&&Object(O.jsx)(N.a,{}),j&&Object(O.jsx)(g.a,{state:"error",closeModal:d,message:j}),Object(O.jsx)("div",{className:"divider"}),Object(O.jsx)("div",{className:"form__heading",children:Object(O.jsx)("h3",{children:"Write a post"})}),Object(O.jsx)("div",{className:"form",children:Object(O.jsxs)("form",{className:"form__body big",onSubmit:function(e){e.preventDefault(),z({title:p,img:P,location:w,creator:t.id})},children:[Object(O.jsxs)("div",{className:"form__user",children:[Object(O.jsx)("div",{className:"form__user--img",children:Object(O.jsx)("img",{src:t.img,alt:"aa"})}),Object(O.jsxs)("div",{className:"form__user--username",children:[Object(O.jsx)("h3",{children:t.username}),w&&Object(O.jsx)("span",{children:w})]})]}),Object(O.jsx)("div",{className:"form__unit my-2",children:Object(O.jsxs)("div",{className:"form__unit features",children:[Object(O.jsx)("textarea",{value:p,name:"body",onChange:function(e){f(e.target.value)},placeholder:"what in your mind..?"}),Object(O.jsx)(T,{previewUrl:I,removeImage:q,setImgData:function(e){G(Object(n.a)({},e))}}),Object(O.jsx)("div",{className:"features__icons",children:Object(O.jsxs)("div",{className:"features__icons--body",children:[Object(O.jsxs)("span",{className:"icon",onClick:function(){C.current.click()},children:[Object(O.jsx)("input",{ref:C,style:{display:"none"},type:"file",accept:".png,.jpg,.jpeg",onChange:function(e){var t;e.target.files&&1===e.target.files.length&&(t=e.target.files[0],U(t))}}),Object(O.jsx)(x.g,{width:"2.2rem",height:"2.4rem",fill:I?"#1D8CF8":"#8B8B85"})]}),Object(O.jsx)(y.a,{handleChange:function(e){f((function(t){return t+e}))},style:{top:"-20rem",left:"-20rem"},className:"emojy-picker"}),Object(O.jsx)(k,{location:w,handleLocation:function(e){E(w?null:e)}})]})})]})}),Object(O.jsx)("button",{disabled:r,className:"btn btn--contained1-primary mg-none",children:r?"Posting....":"Post"})]})})]})})),D=A,I=c(469),M=c.n(I),R=c(484),L=c.n(R),P=(c(489),r.a.memo((function(e){var t=e.currentUser,c=Object(s.useState)([]),r=Object(a.a)(c,2),i=r[0],o=r[1],l=Object(s.useState)(""),j=Object(a.a)(l,2);j[0],j[1];return Object(s.useEffect)((function(){fetch("https://socialbackends.herokuapp.com/video").then((function(e){return e.json()})).then((function(e){o(e.data)}))}),[]),console.log(t),t&&t.img&&t.username?Object(O.jsxs)("div",{className:"post-body",children:[Object(O.jsx)(D,{user:{username:t.username,token:t.token,id:t._id,img:t.img}}),Object(O.jsx)("div",{className:"slider",children:Object(O.jsx)(M.a,Object(n.a)(Object(n.a)({},{dots:!0,infinite:!0,speed:500,slidesToShow:2,slidesToScroll:1}),{},{children:i.map((function(e,t){return Object(O.jsx)(O.Fragment,{children:Object(O.jsx)("div",{children:Object(O.jsx)(L.a,{videoUrl:e.postedByUrl,snapshotAt:10})})})}))}))}),Object(O.jsx)("div",{className:"post__container",children:Object(O.jsx)(f,{uid:t._id,token:t.token,img:t.img,username:t.username})})]}):Object(O.jsx)("div",{children:Object(O.jsx)(d.a,{})})})));t.default=P},63:function(e,t,c){"use strict";c.d(t,"a",(function(){return o}));var n=c(48),a=c.n(n),s=c(49),r=c(18),i=c(0),o=function(){var e=Object(i.useState)(!1),t=Object(r.a)(e,2),c=t[0],n=t[1],o=Object(i.useState)(),l=Object(r.a)(o,2),j=l[0],d=l[1],u=Object(i.useRef)([]),b=Object(i.useCallback)(function(){var e=Object(s.a)(a.a.mark((function e(t){var c,s,r,i,o,l,j=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=j.length>1&&void 0!==j[1]?j[1]:"GET",s=j.length>2&&void 0!==j[2]?j[2]:null,r=j.length>3&&void 0!==j[3]?j[3]:{"Content-Type":"application/json"},n(!0),i=new AbortController,u.current.push(i),e.prev=6,e.next=9,fetch(t,{method:c,body:s,headers:r,signal:i.signal});case 9:return o=e.sent,e.next=12,o.json();case 12:if(l=e.sent,u.current=u.current.filter((function(e){return e!==i})),o.ok){e.next=16;break}throw new Error(l.message);case 16:return n(!1),e.abrupt("return",l);case 20:throw e.prev=20,e.t0=e.catch(6),d(e.t0.message),n(!1),e.t0;case 25:case"end":return e.stop()}}),e,null,[[6,20]])})));return function(t){return e.apply(this,arguments)}}(),[]);return Object(i.useEffect)((function(){return function(){u.current.forEach((function(e){return e.abort()}))}}),[]),{isLoading:c,error:j,sendRequest:b,clearError:function(){d(null)}}}},94:function(e,t,c){"use strict";var n=c(48),a=c.n(n),s=c(8),r=c(49),i=c(18),o=c(0),l=c(52),j=(c(107),c(46)),d=c(63),u=c(9),b=c(16),m=c(21),h=c(534),O=c(3),p=function(e){var t=e.path,c=e.children,n=e.title,s=e.id,l=Object(d.a)(),p=l.isLoading,f=(l.error,l.sendRequest),x=Object(o.useState)(!1),v=Object(i.a)(x,2),_=v[0],g=v[1],N=Object(u.b)(),k=Object(u.c)((function(e){return e.isSignedIn})),y=function(){_&&(g(!1),document.body.style.overflowY="auto")},w=function(){var e=Object(r.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f("https://socialbackends.herokuapp.com/api"+"/posts/".concat(s),"DELETE",null,{"Content-Type":"application/json",Authorization:"Bearer "+k});case 3:N({type:"DELETE_POST",payload:s}),console.log(s),t?N({type:"DELETE_USER_POST",payload:s}):m.a.push(""),y(),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("div",{style:{display:"inline-block"},onClick:function(){_||(g(!0),document.body.style.overflowY="hidden")},children:c}),Object(O.jsx)(h.a,{in:_,timeout:300,classNames:"modal",unmountOnExit:!0,children:Object(O.jsx)("div",{className:"modal__container",onClick:y,children:Object(O.jsx)("div",{className:"modal",children:Object(O.jsx)("div",{className:"modal__body",onClick:function(e){return e.stopPropagation()},children:Object(O.jsxs)("ul",{className:"modal__list",children:[Object(O.jsx)("li",{className:"modal__item",children:Object(O.jsx)(j.a,{onClick:y,to:{pathname:"/posts/edit/".concat(s),state:{title:n}},children:"Edit Post"})}),Object(O.jsx)("li",{className:"modal__item delete",onClick:function(){w()},children:p?"Deleting...":"Delete Post"}),Object(O.jsx)("li",{className:"modal__item",onClick:y,children:"Cancel"})]})})})})}),p&&Object(O.jsx)(b.a,{})]})},f=c(61),x=c(62),v=c(119),_=c(117),g=c(108),N=(c(109),function(e){Object(v.a)(c,e);var t=Object(_.a)(c);function c(e){return Object(f.a)(this,c),t.call(this,e)}return Object(x.a)(c,[{key:"render",value:function(){var e=this.props,t=e.image,c=e.closeLightBox;return Object(O.jsx)("div",{children:Object(O.jsx)(g.a,{mainSrc:t,onCloseRequest:c})})}}]),c}(o.Component)),k=c(59),y=c(149),w=c.n(y);c(105),t.a=function(e){var t,c,n,u,b,m,h,f=e.post,x=e.path,v=e.uid,_=e.token,g=e.img,y=e.username,E=Object(o.useState)(f.liked.indexOf(v)),S=Object(i.a)(E,2),C=S[0],T=S[1],A=Object(o.useRef)(f.liked.length),D=Object(o.useRef)(null),I=Object(d.a)().sendRequest,M=Object(o.useState)(!1),R=Object(i.a)(M,2),L=R[0],P=R[1],U=(w.a,function(){var e=Object(r.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I("https://socialbackends.herokuapp.com/api/posts/post","PATCH",JSON.stringify({postId:f._id,creator:v,img:g,username:y}),{"Content-Type":"application/json",Authorization:"Bearer "+_});case 3:t=e.sent,k.a.emit("action",Object(s.a)(Object(s.a)({},t),{},{type:"SEND_NOTFY"})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}()),B=Object(o.useState)(),F=Object(i.a)(B,2),Y=F[0];F[1];Object(o.useEffect)((function(){if(D.current){var e=setTimeout((function(){U()}),500);return function(){return clearTimeout(e)}}}),[C]);return Object(O.jsxs)("div",{className:"post",children:[L&&Object(O.jsx)(N,{image:L,closeLightBox:function(){return P(!1)}}),Object(O.jsxs)("div",{className:"post__header",children:[Object(O.jsxs)("div",{className:"post__header--info",children:[Object(O.jsxs)("div",{className:"post__header--img",children:[(null===(t=f.creator)||void 0===t?void 0:t.isOnline)&&Object(O.jsx)("div",{className:"userActive"}),Object(O.jsx)(j.a,{to:"/user/".concat((null===f||void 0===f||null===(c=f.creator)||void 0===c?void 0:c._id)||f.creator),children:Object(O.jsx)("img",{src:(null===f||void 0===f||null===(n=f.creator)||void 0===n?void 0:n.img)||g,alt:"aa"})})]}),Object(O.jsxs)("div",{className:"post__header--name",children:[Object(O.jsx)(j.a,{to:"/user/".concat((null===(u=f.creator)||void 0===u?void 0:u._id)||f.creator),children:Object(O.jsx)("span",{className:"name",children:(null===(b=f.creator)||void 0===b?void 0:b.username)||y})}),"null"!==f.location&&Object(O.jsx)("span",{className:"place",children:f.location})]})]}),v===((null===(m=f.creator)||void 0===m?void 0:m._id)?null===(h=f.creator)||void 0===h?void 0:h._id:f.creator)&&Object(O.jsx)(p,{path:x,id:Y||f._id,title:f.title,children:Object(O.jsx)("div",{className:"post__menu",children:Object(O.jsx)("span",{className:"icon",children:Object(O.jsx)(l.A,{width:"2.3rem",height:"2.3rem",fill:"#fff"})})})})]}),f.title&&Object(O.jsx)("div",{className:"post__content",children:Object(O.jsx)("p",{children:f.title?f.title:null})}),f.img&&Object(O.jsx)("div",{className:"post__body",children:Object(O.jsx)("img",{src:f.img,onClick:function(){return P(f.img)}})}),Object(O.jsxs)("div",{className:"post__tail",children:[Object(O.jsxs)("div",{className:"post__tail__communication",children:[Object(O.jsxs)("div",{className:"post__tail__communication__item",children:[Object(O.jsx)("span",{className:"icon",onClick:function(){C<0?++A.current:--A.current,T((function(e){return 0===e?-1:-1*e})),D.current||(D.current=1)},children:C<0?Object(O.jsx)(l.s,{width:"2rem",height:"2rem",fill:"#fff"}):Object(O.jsx)(l.t,{width:"2rem",height:"2rem",fill:"#fff"})}),Object(O.jsx)("span",{className:"nol",children:A.current})]}),Object(O.jsx)(j.a,{to:"/post/".concat(f._id),children:Object(O.jsxs)("div",{className:"post__tail__communication__item",children:[Object(O.jsx)("span",{className:"icon",children:Object(O.jsx)(l.n,{width:"2rem",height:"2rem",fill:"#fff"})}),Object(O.jsx)("span",{className:"nol",children:f.comments?f.comments.length:0})]})})]}),Object(O.jsx)("div",{className:"post__tail--time-left",children:function(e){var t=new Date,c=new Date(e).getTime(),n=(t.getTime()-c)/36e5;if(n<1){var a=Math.ceil(60*n);return a+(1===a?" MINUTE":" MINUTES")+" AGO"}if(n<24){var s=Math.floor(n);return s+(1===s?" Hour":" Hours")+" AGO"}if(n<168){var r=Math.floor(n/24);return r+" Day AGO"}if(n<720){var i=Math.floor(n/168);return i+(1===i?" Week":" Weeks")+" AGO"}if(n<8760){var o=Math.floor(n/720);return o+(1===o?" Month":" Months")+" AGO"}var l=Math.floor(n/8760);return l+(1===l?" Year":" Years")+" AGO"}(f.createdAt)})]})]},f._id)}}}]);
//# sourceMappingURL=11.312f1897.chunk.js.map